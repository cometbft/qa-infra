- name: runload
  become: false
  gather_facts: yes
  hosts: validators
  vars:
    ansible_host_key_checking: false
  tasks:
    - name: create script
      template:
        src: templates/runload.sh.j2
        dest: /usr/bin/runload.sh
      become: yes
    - name: add execute to script
      file:
        path: /usr/bin/runload.sh
        mode: 'u+x'
      become: yes
    - name: create unit file
      template:
        src: templates/runload.service.j2
        dest: /lib/systemd/system/runload.service
      become: yes
    - name: start the systemd-unit
      ansible.builtin.systemd:
        name: runload
        state: started
        daemon_reload: yes
        enabled: yes
    - name: restart the systemd-unit # not sure why this is necessary
      ansible.builtin.systemd:
        name: runload
        state: restarted
        daemon_reload: yes
        enabled: yes
